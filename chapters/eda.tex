\chapter{Análisis exploratorio de datos}\label{ch: eda}
El análisis exploratorio de los datos se va a dividir en dos grupos. El primero de ellos consiste en el análisis del dataset a partir de los metadatos insertados en la base de datos. El segundo consiste en el estudio y el análisis de los datos de audio descargados y cómo éstos van a ser tratados.

\section{Análisis del volumen e integridad de los datos a través de sus metadatos}
Los metadatos han sido divididos en dos tablas en función del lugar a dónde pertenecen. La primera tabla hace referencia a las pistas de los audiolibros y la segunda a los ruidos. La tabla \ref{tab: audio_book_table} presenta la columnas que contiene la tabla de las pistas de audio y la \ref{tab: noise_table} los metadatos de las pistas de ruido.

\begin{table} [ht!]
	\centering
	\resizebox{\columnwidth}{!}{%
		\begin{tabular}{L{5cm} C{3cm} L{15cm}}
			\toprule
			\textbf{Nombre} & \textbf{Tipo de dato} & \textbf{Descripción}\\ \midrule
			id & int & Identificador de la pista de audio \\ \midrule
			book\_name\_dummy & text & Nombre del libro con caracteres \acrshort{ASCII} reducidos \\ \midrule
			book\_name & text & Nombre completo del libro \\ \midrule
			book\_author & text & Autor del libro \\ \midrule
			book\_url & text & \gls{URL} de descarga del libro \\ \midrule
			book\_language & text & Lenguaje del libro \\ \midrule
			book\_path & text & Dirección de almacenamiento del libro comprimido \\ \midrule
			book\_n\_tracks & int & Número de pistas del libro \\ \midrule
			track\_name & text & Nombre de la pista de audio \\ \midrule
			track\_path & text & Directorio de almacenamiento de la pista de audio \\ \midrule
			track\_channels & int & Número de canales de la pista de audio \\ \midrule
			track\_sample\_rate & int & Tasa de muestreo de la pista de audio \\ \midrule
			track\_duration & real & Duración de la pista de audio \\ \midrule
			track\_status & text & Estado del archivo (OK\arrowTikz{0}descargado, DELETED\arrowTikz{0}eliminado) \\ \midrule
			track\_insert\_datetime & int & Fecha y hora de inserción del registro \\ \bottomrule
		\end{tabular}
	}
	\vspace*{3pt}
	\caption{Columnas de la tabla pista de los audiolibros}\label{tab: audio_book_table}
\end{table}

\begin{table} [ht!]
	\centering
	\resizebox{\columnwidth}{!}{%
		\begin{tabular}{L{5cm} C{3cm} L{15cm}}
			\toprule
			\textbf{Nombre} & \textbf{Tipo de dato} & \textbf{Descripción}\\ \midrule
			id & int & Identificador de la pista de ruido \\ \midrule
			name & text & Nombre del ruido que coincide con el nombre del archivo \acrshort{ASCII} reducidos \\ \midrule
			url & text & \gls{URL} de descarga del video que contiene el ruido \\ \midrule
			path & text & Dirección de almacenamiento de la pista de ruido \\ \midrule
			channels & int & Número de canales de la pista de ruido \\ \midrule
			sample\_rate & int & Tasa de muestreo de la pista de ruido \\ \midrule
			duration & real & Duración de la pista de ruido \\ \midrule
			status & text & Estado del archivo (OK\arrowTikz{0}descargado, DELETED\arrowTikz{0}eliminado) \\ \midrule
			insert\_datetime & int & Fecha y hora de inserción del registro \\ \bottomrule
		\end{tabular}
	}
	\vspace*{3pt}
	\caption{Columnas de la tabla con los metadatos de las pista de ruido}\label{tab: noise_table}
\end{table}

A partir de las tablas se pueden sacar datos que den una idea de la dimensión del problema y si los datos son compatibles entre ellos o no. Dos pistas de audio pueden ser no compatibles porque el algoritmo se diseña para una tasa de muestreo estática y, las pistas de audio o ruido, no tienen por qué tener tasas de muestreo que sean múltiplos y divisores comunes de la del modelo. En primer lugar se pueden ver la duración total de las pista de audiolibros y de ruido, para ello simplemente se lanza una query \textbf{agregando por el campo duración} con la función \textbf{SUM} como muestra la tabla \ref{tab: duration}.
\begin{table} [b!]
	\centering
	\resizebox{!}{!}{%
		\begin{tabular}{L{3cm} C{3cm} C{3cm}}
			\toprule
			\textbf{Tipo de pista} & \textbf{Duración [horas]} & \textbf{Tasas de muestreo [$\frac{muestras}{segundo}$]}\\ \midrule
			Audiolibros & 707.70\footnote[1]{Este dato es previo a la eliminación de pistas repetidas. El dato real es \textbf{555.73 horas}} & [22050]\\ \midrule
			Ruido & 52.91 & [44100, 48000]\\ \bottomrule
		\end{tabular}
	}
	\vspace*{3pt}
	\caption{Duración total de todas las pistas}\label{tab: duration}
\end{table}

Otra métrica interesante es, como se comentó anteriormente, la compatibilidad de tasas de muestreo. Para ello se \textbf{agrega por el campo tasa de muestreo} con la función \textbf{DISTINCT}. El resultado se encuentra en la tabla \ref{tab: duration}.

A parte de obtener métricas, se puede analizar la consistencia de los datos. Por ejemplo, se podría analizar si existen algunas pista de audio que se encuentren en varios libros. Esto se daría si la plataforma de almacenamiento metiera varios libros en una misma \gls{URL} de descarga. En \ref{lst: repeat_track} se puede ver el código que implementa la query.

\begin{lstlisting}[style=SQL,basicstyle=\tiny\ttfamily, caption={Query para obtener las pistas repetidas en varios libros},captionpos=b, label={lst: repeat_track}]
SELECT track_name, COUNT(*) AS c
FROM audio_books_tracks
GROUP BY track_name
HAVING c > 1
ORDER BY c DESC
\end{lstlisting}

El resultado de esta query es que hay \textbf{162} registros que se encuentran, como mínimo, dos veces. Por tanto hay pistas de audiolibros que se han contado varias veces falseando las estadísticas. Pasando de las \textbf{707.70 horas} de la tabla \ref{tab: duration} a \textbf{555.73 horas}.

Realizando una query con alguno de los resultados se confirma que existen pistas que se encuentran en varios libros y, por tanto, son registros repetidos. En la tabla \ref{tab: repeat_registers} se puede ver una de las pistas que se encuentra repetida. Con este tipo de queries se puede ver que de los \textbf{4227} registros, únicos son \textbf{2802}.
\begin{table} [h!]
	\centering
	\resizebox{\textwidth}{!}{%
		\begin{tabular}{L{0.6cm} L{7cm} L{10cm}}
			\toprule
			\textbf{id} & \textbf{book\_name} & \textbf{track\_name}\\ \midrule
			1351 & Antología de Cuentos Fantásticos & antologiacuentosfantasticos\_01\_various\_64kb.mp3 \\ \midrule
			3410 & Coppelius (1ra Parte) (in  Antología de Cuentos Fantásticos ) & antologiacuentosfantasticos\_01\_various\_64kb.mp3 \\ \midrule
			3935 & De lo que aconteció a un deán de Santiago con don Illan el mágico, que moraba en Toledo (in  Antología de Cuentos Fantásticos ) & antologiacuentosfantasticos\_01\_various\_64kb.mp3 \\ \midrule
		\end{tabular}
	}
	\vspace*{3pt}
	\caption{Ejemplo de registros repetidos}\label{tab: repeat_registers}
\end{table}

\section{Análisis de los datos de audio}
